{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isValidKeyLength = exports.isConstantTime = exports.isNode = exports.isBrowser = exports.assert = void 0;\n\nconst constants_1 = require(\"./constants\");\n\nconst env_1 = require(\"./env\");\n\nfunction assert(condition, message) {\n  if (!condition) {\n    throw new Error(message || 'Assertion failed');\n  }\n}\n\nexports.assert = assert;\n\nfunction isBrowser() {\n  return !!env_1.getBrowerCrypto() && !!env_1.getSubtleCrypto();\n}\n\nexports.isBrowser = isBrowser;\n\nfunction isNode() {\n  return typeof process !== 'undefined' && typeof process.versions !== 'undefined' && typeof process.versions.node !== 'undefined';\n}\n\nexports.isNode = isNode;\n\nfunction isConstantTime(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n\n  let res = 0;\n\n  for (let i = 0; i < arr1.length; i++) {\n    res |= arr1[i] ^ arr2[i];\n  }\n\n  return res === 0;\n}\n\nexports.isConstantTime = isConstantTime;\n\nfunction isValidKeyLength(length) {\n  return !(length <= constants_1.LENGTH_0 || length > constants_1.MAX_KEY_LENGTH || parseInt(String(length)) !== length);\n}\n\nexports.isValidKeyLength = isValidKeyLength;","map":{"version":3,"sources":["../../../src/helpers/validators.ts"],"names":[],"mappings":";;;;;;;AAAA,MAAA,WAAA,GAAA,OAAA,CAAA,aAAA,CAAA;;AACA,MAAA,KAAA,GAAA,OAAA,CAAA,OAAA,CAAA;;AAEA,SAAgB,MAAhB,CAAuB,SAAvB,EAA2C,OAA3C,EAA0D;AACxD,MAAI,CAAC,SAAL,EAAgB;AACd,UAAM,IAAI,KAAJ,CAAU,OAAO,IAAI,kBAArB,CAAN;AACD;AACF;;AAJD,OAAA,CAAA,MAAA,GAAA,MAAA;;AAMA,SAAgB,SAAhB,GAAyB;AACvB,SAAO,CAAC,CAAC,KAAA,CAAA,eAAA,EAAF,IAAuB,CAAC,CAAC,KAAA,CAAA,eAAA,EAAhC;AACD;;AAFD,OAAA,CAAA,SAAA,GAAA,SAAA;;AAIA,SAAgB,MAAhB,GAAsB;AACpB,SACE,OAAO,OAAP,KAAmB,WAAnB,IACA,OAAO,OAAO,CAAC,QAAf,KAA4B,WAD5B,IAEA,OAAO,OAAO,CAAC,QAAR,CAAiB,IAAxB,KAAiC,WAHnC;AAKD;;AAND,OAAA,CAAA,MAAA,GAAA,MAAA;;AAQA,SAAgB,cAAhB,CAA+B,IAA/B,EAAiD,IAAjD,EAAiE;AAC/D,MAAI,IAAI,CAAC,MAAL,KAAgB,IAAI,CAAC,MAAzB,EAAiC;AAC/B,WAAO,KAAP;AACD;;AACD,MAAI,GAAG,GAAG,CAAV;;AACA,OAAK,IAAI,CAAC,GAAG,CAAb,EAAgB,CAAC,GAAG,IAAI,CAAC,MAAzB,EAAiC,CAAC,EAAlC,EAAsC;AACpC,IAAA,GAAG,IAAI,IAAI,CAAC,CAAD,CAAJ,GAAU,IAAI,CAAC,CAAD,CAArB;AACD;;AACD,SAAO,GAAG,KAAK,CAAf;AACD;;AATD,OAAA,CAAA,cAAA,GAAA,cAAA;;AAWA,SAAgB,gBAAhB,CAAiC,MAAjC,EAA+C;AAC7C,SAAO,EACL,MAAM,IAAI,WAAA,CAAA,QAAV,IACA,MAAM,GAAG,WAAA,CAAA,cADT,IAEA,QAAQ,CAAC,MAAM,CAAC,MAAD,CAAP,CAAR,KAA6B,MAHxB,CAAP;AAKD;;AAND,OAAA,CAAA,gBAAA,GAAA,gBAAA","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isValidKeyLength = exports.isConstantTime = exports.isNode = exports.isBrowser = exports.assert = void 0;\nconst constants_1 = require(\"./constants\");\nconst env_1 = require(\"./env\");\nfunction assert(condition, message) {\n    if (!condition) {\n        throw new Error(message || 'Assertion failed');\n    }\n}\nexports.assert = assert;\nfunction isBrowser() {\n    return !!env_1.getBrowerCrypto() && !!env_1.getSubtleCrypto();\n}\nexports.isBrowser = isBrowser;\nfunction isNode() {\n    return (typeof process !== 'undefined' &&\n        typeof process.versions !== 'undefined' &&\n        typeof process.versions.node !== 'undefined');\n}\nexports.isNode = isNode;\nfunction isConstantTime(arr1, arr2) {\n    if (arr1.length !== arr2.length) {\n        return false;\n    }\n    let res = 0;\n    for (let i = 0; i < arr1.length; i++) {\n        res |= arr1[i] ^ arr2[i];\n    }\n    return res === 0;\n}\nexports.isConstantTime = isConstantTime;\nfunction isValidKeyLength(length) {\n    return !(length <= constants_1.LENGTH_0 ||\n        length > constants_1.MAX_KEY_LENGTH ||\n        parseInt(String(length)) !== length);\n}\nexports.isValidKeyLength = isValidKeyLength;\n//# sourceMappingURL=validators.js.map"]},"metadata":{},"sourceType":"script"}